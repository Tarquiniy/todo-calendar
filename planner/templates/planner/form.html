{% extends 'planner/base.html' %}
{% block content %}
<div class="container my-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="glass-card p-4 animated-item">
        <h1 class="display-5 fw-bold text-gradient mb-4">
          <span class="text-primary">✏️</span> {{ title }}
        </h1>
        
        <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
          {% csrf_token %}
          
          <div class="mb-4">
            <label class="form-label fw-bold">Заголовок</label>
            {{ form.title }}
            <div class="invalid-feedback">Пожалуйста, введите заголовок задачи</div>
          </div>
          
          <div class="row g-3 mb-4">
            <div class="col-md-6">
              <label class="form-label fw-bold">Начало</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-clock"></i></span>
                {{ form.start }}
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label fw-bold">Окончание</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-clock"></i></span>
                {{ form.end }}
              </div>
            </div>
          </div>
          
          <div class="mb-4">
            <label class="form-label fw-bold">Описание</label>
            {{ form.content }}
          </div>
          
          <div class="row g-3 mb-4">
            <div class="col-md-4">
              <label class="form-label fw-bold">Статус</label>
              {{ form.status }}
            </div>
            <div class="col-md-4">
              <label class="form-label fw-bold">Приоритет</label>
              {{ form.priority }}
            </div>
            <div class="col-md-4">
              <label class="form-label fw-bold">Категория</label>
              {{ form.category }}
            </div>
          </div>
          
          <div class="mb-4">
            <div class="form-check form-switch">
              {{ form.repeat_daily }}
              <label class="form-check-label fw-bold">{{ form.repeat_daily.label }}</label>
            </div>
          </div>
          
          <div class="mb-4">
            <label class="form-label fw-bold">Вложение</label>
            {{ form.attachment }}
          </div>
          
          <div class="d-flex justify-content-between">
            <a href="{% url 'index' %}" class="btn btn-secondary">
              <i class="bi bi-arrow-left me-2"></i> Отмена
            </a>
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-save me-2"></i> Сохранить
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  // Валидация формы
  document.addEventListener('DOMContentLoaded', function() {
    const forms = document.querySelectorAll('.needs-validation');
    
    Array.from(forms).forEach(form => {
      form.addEventListener('submit', function(event) {
        if (!form.checkValidity()) {
          event.preventDefault();
          event.stopPropagation();
        }
        
        form.classList.add('was-validated');
      }, false);
    });
    
    // Стилизация элементов формы
    document.querySelectorAll('input, select, textarea').forEach(el => {
      el.classList.add('form-control');
      if (el.tagName === 'SELECT') {
        el.classList.add('form-select');
      }
    });
  });
</script>
{% endblock %}