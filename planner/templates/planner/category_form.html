{% extends 'planner/base.html' %}

{% block content %}
<div class="container my-4">
  <div class="row justify-content-center">
    <div class="col-lg-6">
      <div class="glass-card p-4 animated-item">
        <h1 class="display-5 fw-bold text-gradient mb-4">
          <span class="text-primary">üìÅ</span> {{ title }}
        </h1>

        <form method="post">
          {% csrf_token %}

          <div class="mb-4">
            <label class="form-label fw-bold">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
            {{ form.name }}
            <div class="invalid-feedback">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</div>
          </div>

          <div class="mb-4">
            <label class="form-label fw-bold">–¶–≤–µ—Ç</label>
            <div class="input-group">
              {{ form.color }}
              <span class="input-group-text color-preview" style="background-color: {{ form.color.value|default:'#6a11cb' }};"></span>
            </div>
          </div>

          <div class="d-flex justify-content-between">
            <a href="{% url 'categories' %}" class="btn btn-secondary">
              <i class="bi bi-arrow-left me-2"></i> –û—Ç–º–µ–Ω–∞
            </a>
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-save me-2"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.querySelector('form');

  form.addEventListener('submit', function(e) {
    if (!form.checkValidity()) {
      e.preventDefault();
      e.stopPropagation();
    }

    form.classList.add('was-validated');
  }, false);

  // –ü—Ä–æ—Å–º–æ—Ç—Ä —Ü–≤–µ—Ç–∞
  const colorInput = document.querySelector('input[name="color"]');
  const colorPreview = document.querySelector('.color-preview');
  
  if (colorInput && colorPreview) {
    colorInput.addEventListener('input', function() {
      colorPreview.style.backgroundColor = this.value;
    });
  }
});
</script>
{% endblock %}